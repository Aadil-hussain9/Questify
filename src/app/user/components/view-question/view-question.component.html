<div class="min-h-screen bg-gray-50 py-6">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="bg-white rounded-lg shadow-sm overflow-hidden">
      <!-- Scrollable container -->
      <div class="max-h-[90vh] overflow-y-auto">
        <!-- Question Section -->
        <div class="border-b border-gray-200 p-6">
          <div class="flex gap-6">
            <!-- Vote Section -->
            <div class="flex flex-col items-center space-y-2">
              <button
                mat-icon-button
                class="rounded-full p-2 transition-colors"
                (click)="addVoteToQuestion('UPVOTE', question.voted)">
                <mat-icon [ngClass]="{'text-green-600': question.voted === 1}">arrow_upward</mat-icon>
              </button>
              <span class="text-xl font-semibold">{{ question.voteCount }}</span>
              <button mat-icon-button
                      class="rounded-full p-2"
                      (click)="addVoteToQuestion('DOWNVOTE', question.voted)">
                <mat-icon [ngClass]="{'text-red-600': question.voted === -1}">arrow_downward</mat-icon>
              </button>
            </div>

            <!-- Question Content -->
            <div class="flex-1">
              <h6 class="text-2xl font-normal bg-clip-text  mb-2">
                {{ question.title }}
              </h6>
              <div class="text-sm text-gray-500 mb-4">
                Asked by <span class="font-medium">{{ question.userName }}</span> on
                <span>{{ getFormattedDate(question.datePosted) }}</span> -
                Viewed <span class="font-medium">{{ question.viewCount }}</span> times
              </div>
              <p class="text-gray-700 mb-4">{{ question.body }}</p>
              <div class="flex flex-wrap gap-2">
                <mat-chip-listbox>
                  <mat-chip *ngFor="let tag of question.tags"
                            class="bg-blue-100 text-blue-800">{{ tag }}</mat-chip>
                </mat-chip-listbox>
              </div>
            </div>
          </div>
        </div>

        <!-- Answers Section -->
        <div class="p-6">
          <h5 class="text-xl font-semibold mb-6">{{ answers.length }} Answers</h5>

          <div class="space-y-6">
            <div *ngFor="let answer of answers"
                 class="border border-gray-200 rounded-lg p-6">
              <div class="flex gap-6">
                <!-- Vote Section -->
                <div class="flex flex-col items-center space-y-2">
                  <button mat-icon-button
                          class="rounded-full p-2"
                          (click)="addVoteToAnswer('UPVOTE', answer.id, answer.voted)">
                    <mat-icon [ngClass]="{'text-green-600': answer.voted === 1}" class="text-green-600">arrow_upward</mat-icon>
                  </button>
                  <span class="text-xl font-semibold">{{ answer.voteCount }}</span>
                  <button mat-icon-button
                          class="rounded-full p-2"
                          (click)="addVoteToAnswer('DOWNVOTE', answer.id, answer.voted)">
                    <mat-icon [ngClass]="{'text-red-600': answer.voted === -1}">arrow_downward</mat-icon>
                  </button>
                  <mat-icon *ngIf="answer.approved"
                            class="text-green-600"
                            matTooltip="Approved Answer">check_circle</mat-icon>
                </div>

                <!-- Answer Content -->
                <div class="flex-1">
                  <div class="text-sm text-gray-500 mb-2">
                    Answered by
                    <span class="font-medium">
                      {{ answer.userId === question.userId ? 'Author of Question ✓' : answer.userName }}
                    </span>
                    on {{ getFormattedDate(answer.postedDate) }}
                  </div>
                  <p class="text-gray-700 mb-4">{{ answer.body }}</p>

                  <img *ngIf="answer.convertedImg"
                       [src]="answer.convertedImg"
                       alt="Answer Image"
                       class="max-w-md rounded-lg mb-4">

                  <!-- Comments Section -->
                  <div class="mt-4 space-y-4">
                    <div *ngFor="let comment of answer.answerComments"
                         class="pl-4 border-l-2 border-gray-200">
                      <p class="text-gray-700">{{ comment.body }}</p>
                      <div class="text-sm text-gray-500">
                        {{ comment.userName }} - {{ getFormattedDate(comment.createdDate) }}
                      </div>
                    </div>
                  </div>

                  <!-- Add Comment -->
                  <div class="mt-4 flex gap-2">
                    <mat-form-field class="flex-1">
                      <input matInput #comment placeholder="Add a comment...">
                    </mat-form-field>
                    <button mat-button color="primary"
                            (click)="addCommentToAnswer(comment, answer.id)">
                      Comment
                    </button>
                  </div>
                </div>
              </div>
              <button *ngIf="!answer.approved && question.userId === currentUserId"
                      (click)="approveAnswer(answer.id)"
                      class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400">
                Approve this Answer
              </button>
            </div>
          </div>
        </div>

        <!-- Post Answer Section -->
        <div class="border-t border-gray-200 p-6">
          <h6 class="text-xl font-semibold mb-6">Post Your Answer ⌨️</h6>
          <form [formGroup]="validateForm" (ngSubmit)="addAnswer()" class="space-y-4">
            <mat-form-field class="w-full">
              <textarea matInput rows="4"
                        placeholder="Write your answer..."
                        formControlName="body"></textarea>
            </mat-form-field>

            <!-- Image Upload -->
            <div *ngIf="imagePreview" class="max-w-md mb-4">
              <img [src]="imagePreview"
                   alt="Preview"
                   class="rounded-lg">
            </div>
            <input type="file"
                   accept="image/png, image/jpeg"
                   class="block w-full text-sm text-gray-500
                          file:mr-4 file:py-2 file:px-4
                          file:rounded-full file:border-0
                          file:text-sm file:font-semibold
                          file:bg-blue-50 file:text-blue-700
                          hover:file:bg-blue-100"
                   (change)="onFileSelected($event)">

            <button mat-raised-button
                    [disabled]="validateForm.invalid"
                    class="px-6 py-2 rounded-full bg-pink-500 text-white">
              Post Your Answer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
